<!DOCTYPE html>
<html lang="en" >

<head>
	<meta charset="UTF-8">
	<title>Marathon</title>
  
	<!-- Externals js required -->
	<script type='text/javascript' src='./js/external/jquery-2.1.4.min.js'></script>
	<script type='text/javascript' src='./js/external/htmlCanvas.js'></script> 

	<!-- External js -->
	<script type='text/javascript' src='./js/external/codeMirror/codemirror.js'></script> 
	<script type='text/javascript' src='./js/external/codeMirror/addons/matchbrackets.js'></script> 
	<script type='text/javascript' src='./js/external/codeMirror/modes/xml.js'></script>
	<script type='text/javascript' src='./js/external/codeMirror/modes/htmlmixed.js'></script> 
	<script type='text/javascript' src='./js/external/codeMirror/modes/javascript.js'></script>
	<script type='text/javascript' src='./js/external/codeMirror/modes/css.js'></script>  
	
	<!-- Externals  css -->
	<link rel="stylesheet" href="./css/external/codemirror.css" rel="stylesheet"
	
	<!-- Marathon js libraries  -->
	<script type='text/javascript' src='./js/layout.js'></script> 
	<script type='text/javascript' src='./js/tutorial.js'></script>
		
	<!-- Marathon css libraries  -->
	<link rel="stylesheet" href="./css/buttons.css" rel="stylesheet">
	<link rel="stylesheet" href="./css/tutorial.css" rel="stylesheet">

	<!-- Demo css  -->
	<link rel="stylesheet" href="./css/demo.css" rel="stylesheet">
  
</head>

	<body>
		
		<script>

			var debug;
		
			function replaceAll(str, find, replace) {
				return str.replace(new RegExp(find, 'g'), replace);
			}
			
			function Header() {
			
				var that = htmlCanvas.widget();
				
				that.renderOn = function(html) {
					html.h1("Marathon");
				}
				
				return that
			}

			function Browser() {
			
				var that = htmlCanvas.widget();
				
				that.renderOn = function(html) {
					sidebar = html.div().addClass("sidebar").asJQuery();	
					nav = html.div().addClass("nav").asJQuery();
					nav.appendTo(sidebar);
					html.span("Start").addClass("page selected").click(function(){showStart($(this))}).asJQuery().appendTo(nav);
					html.span("Atomic").asJQuery().appendTo(nav);
					AtomicMenu().appendTo(nav);
					html.span("Complex").asJQuery().appendTo(nav);
					ComplexMenu().appendTo(nav);
					html.div().setAttribute('id', 'container');
					StartPage().appendTo($("#container"))
				}
				
				function resetContainer() {
					container = $('#container');
					container.html('');
				}
				
				function showStart(item) {
					resetContainer();
					$(".selected").removeClass("selected");
					item.addClass("selected");
					StartPage().appendTo($("#container"));
				}
								
				return that
			}
	
			function StartPage() {
			
				var that = htmlCanvas.widget();
				
				that.renderOn = function(html) {
					container = html.div().addClass("panel").asJQuery();
					html.h2("How to start ?").asJQuery().appendTo(container);
					renderer = html.div().addClass("renderer").asJQuery();
					renderer.appendTo(container);
					var code = '<script type="text/javascript" src="./src/marathon.min.js">\n<link rel="sylesheet" href="./src/marathon.min.css">';
						var editor = CodeMirror(renderer[0], {
						value: code,
						mode: "xml",
						matchbrackets: true
					});
					html.span().addClass("copy").click(function () {copy($(this).prev().find(".CodeMirror-line"))}).asJQuery().appendTo(renderer);
				}
				
				function copy(element) {
					debug = element;
					var $temp = $("<textarea>");
					$("body").append($temp);
					str = replaceAll(element.text(), '><', '>\n<');
					$temp.val(str).select();
					document.execCommand("copy");
					$temp.remove();
				}
								
				return that
			}
	
	
			function AtomicMenu() {
			
				var that = htmlCanvas.widget();
				var nav;
				
				that.renderOn = function(html) {
					nav = html.div().addClass("nav").asJQuery();
					html.span("CSS").asJQuery().appendTo(nav);
					CssMenu().appendTo(nav);
				}
				
				return that
			}
			
			function ComplexMenu() {
			
				var that = htmlCanvas.widget();
				var nav;
				
				that.renderOn = function(html) {
					nav = html.div().addClass("nav").asJQuery();
					html.span("Modes").asJQuery().appendTo(nav);
					ModesMenu().appendTo(nav);
				}
				
				return that
			}
			
	
			function CssMenu() {
			
				var that = htmlCanvas.widget();
				
				that.renderOn = function(html) {
					html.span("Buttons").addClass("page").click(function(){showButtons($(this))});
					html.span("Layout").addClass("page").click(function(){showLayout($(this))})
				}
					
				function resetContainer() {
					container = $('#container');
					container.html('');
				}

				function showButtons(item) {
					resetContainer();
					$(".selected").removeClass("selected");
					item.addClass("selected");
					Buttons().appendTo(container);
				}
				
				function showLayout(item) {
					resetContainer();	
					$(".selected").removeClass("selected");
					item.addClass("selected");
					Layouts().appendTo(container);
				}
			
				return that
			}
			
			function ModesMenu() {
			
				var that = htmlCanvas.widget();
				
				that.renderOn = function(html) {
					html.span("Tutorial").addClass("page").click(function(){showTutorial($(this))});
				}
					
				function resetContainer() {
					container = $('#container');
					container.html('');
				}

				function showTutorial(item) {
					resetContainer();
					$(".selected").removeClass("selected");
					item.addClass("selected");
					Tutorial().appendTo(container);
				}
							
				return that
			}
			
			function Tutorial() {
					
				var that = htmlCanvas.widget();
				
				that.renderOn = function(html) {
					div = html.div().addClass("panel tutorial").asJQuery();
					html.h1("Example title").asJQuery().appendTo(div);
					html.span("This is a first comment on this element...").addClass("mr-comment").asJQuery().appendTo(div);
					html.p("Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.").asJQuery().appendTo(div);
					html.span("This is an other comment on this element...").addClass("mr-comment").asJQuery().appendTo(div);
					html.p("Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.").asJQuery().appendTo(div);
					html.span("This is an other comment on this element...").addClass("mr-comment").asJQuery().appendTo(div);
					html.button("Example").addClass("primary").click(function () {openTutorial()}).asJQuery().appendTo(div);
				}
								
				return that
			}
			
			function Buttons () {
				
				var that = htmlCanvas.widget();
				var classes = ['default', 'success', 'primary', 'warning', 'danger'];
				
				that.renderOn = function(html) {
					for(i in classes) {
						c = classes[i];
						panel = html.div().addClass('panel buttons').asJQuery();
						code = '<button class="' + c + '"></button>';
						renderer = html.div().addClass("renderer").asJQuery();
						renderer.appendTo(panel);
						var editor = CodeMirror(renderer[0], {
							value: code,
							matchbrackets: true
						});
						html.span().addClass("copy").click(function () {copy($(this).prev().find(".CodeMirror-line"))}).asJQuery().appendTo(renderer);
						html.button(c).addClass(c).asJQuery().appendTo(panel);
					}
				}
				
				function copy(element) {
					debug = element;
					var $temp = $("<input>");
					$("body").append($temp);
					$temp.val(element.text()).select();
					document.execCommand("copy");
					$temp.remove();
				}
				
				return that
			}
			
			function Layouts() {
			
				var that = htmlCanvas.widget();
				var isAiry = false;
				var count = 1;

				that.renderOn = function(html) {
					boxes = html.div().addClass('boxes b-4').asJQuery();
					html.span('Box number :').addClass("box").asJQuery().appendTo(boxes);
					
					select = html.select().addClass("box").asJQuery();
					select.change(function (event) {count = event.target.value; generateLayouts()});
					select.appendTo(boxes);

					var i = 1;
					while(i<13) {
						html.option(i.toString()).setAttribute("value", i).asJQuery().appendTo(select);
						i++
					}

					html.span('Is airy :').addClass("box").asJQuery().appendTo(boxes);
					select = html.select().addClass("box").asJQuery();
					select.change(function (event) {isAiry = event.target.value != false; generateLayouts()});
					select.appendTo(boxes);

					html.option('no').setAttribute("value", 0).asJQuery().appendTo(select);
					html.option('yes').setAttribute("value", 1).asJQuery().appendTo(select);

					html.div().setAttribute("id", "builder");
					
					html.div().addClass("renderer");
					
					generateLayouts(1);
					
				}
				
				function generateLayouts() {
					$("#builder").html("")
					Builder(count, isAiry).appendTo($("#builder"));
					$(".renderer").html("");
					code = replaceAll(replaceAll(replaceAll(replaceAll($("#builder").html(), " dark", ""), "><div", ">\n\t<div"), "</div><div", "</div>\n<div"), "</div></div>", "</div>\n</div>");
					
					var editor = CodeMirror($(".renderer")[0], {
						value: code,
						matchbrackets: true
					});
					
					LayoutCopy().appendTo($(".renderer"))
				}
				
				return that
			}
			
			function LayoutCopy () {
				
				var that = htmlCanvas.widget();

				that.renderOn = function(html) {
					html.span().addClass("copy").click(function () {copy($(this).prev().find(".CodeMirror-line"))})
				}
				
				function copy(element) {
					debug = element;
					var $temp = $("<textarea>");
					$("body").append($temp);
					str = replaceAll(replaceAll(element.text(), "    ", "\n\t"), "</div></div>", "</div>\n</div>");
					$temp.val(str).select();
					document.execCommand("copy");
					$temp.remove();
				}
				
				return that
			}
			
			function Builder(number, isAiry){
				
				var that = htmlCanvas.widget();
				
				that.renderOn = function(html) {
					boxes = html.div().addClass("boxes b-" + number).asJQuery();
					if(isAiry) {
						boxes.addClass("airy");
					}
					var i = 0;
					while(i<number) {						
						box = html.div().addClass("box").asJQuery();
						if(i % 2) {
							box.addClass("dark");
						}
						//if(number>1 && number<6) {
						//	buttons = html.div().addClass("buttons").asJQuery();
						//	buttons.appendTo(box);
						//	button = html.button().addClass("default").asJQuery();
						//	button.html("&#8614; &#8612;");
						//	button.click(function () {decrease($(this))});
						//	button.appendTo(buttons);
						//	button = html.button().addClass("primary").asJQuery();
						//	button.html("&#8596;");
						//	button.click(function () {increase($(this))});
						//	button.appendTo(buttons);
						//}
						box.appendTo(boxes);
						i++	
					}

				}
				
				function increase(button) {
					
				}
				
				function decrease(element) {
					
				}

				return that
			}
	
			Header().appendTo($('body'));
			
			Browser().appendTo($('body'));	
	
		</script>
	</body>

</html>
